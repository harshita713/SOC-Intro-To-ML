#! /usr/bin/python
# -*- coding: utf-8 -*-
'''
    This file handles data interpolation.
    Interpolation is used to fill in missing values in the data.
'''

import os
import sys
import pandas as pd


def interpolate(dataframe, cols_to_interpolate):
    '''
        This function fills missing values in the given columns 
        using spline interpolation (smooth curve fitting).
    '''
    for col in cols_to_interpolate:
        # Use spline interpolation of order 2 (quadratic curve) to fill gaps
        dataframe[col] = dataframe[col].interpolate('spline', order=2)
    
    return dataframe


def main(dir_path):
    '''
        This function reads all CSV files in the given folder,
        applies interpolation on selected columns, and prints 
        the processed data of the first file.
    '''
    files = os.listdir(dir_path)  # List all files in the folder
    
    for file_name in files:
        # Read the CSV file into a pandas DataFrame
        dataframe = pd.read_csv(os.path.join(dir_path, file_name))
        
        # Apply interpolation on these selected columns
        dataframe = interpolate(dataframe, 
            ['high', 'open', 'low', 'close', 'volume', 'adj_close'])
        
        # Print the resulting DataFrame (for checking purpose)
        print dataframe
        
        # Stop after processing the first file (break is used here)
        break


# This part runs when script is executed directly from terminal
if __name__ == "__main__":
    main(sys.argv[1])
